<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAHAYA HASTHA - Receipt Printing App</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #printArea, #printArea * {
                visibility: visible;
            }
            #printArea {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none !important;
            }
        }
        .receipt-preview {
            background: white;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .item-row:hover {
            background-color: #f9fafb;
        }
        .trust-logo {
            font-family: 'Georgia', serif;
            letter-spacing: 2px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen py-8 px-4">
    <div class="max-w-4xl mx-auto">
        <!-- Trust Settings (Collapsible) -->
        <div class="bg-blue-50 rounded-lg p-4 mb-6">
            <button onclick="toggleSettings()" class="flex items-center gap-2 text-sm font-medium text-blue-700 hover:text-blue-900">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                Trust Settings
                <svg id="settingsChevron" class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>
            <div id="settingsPanel" class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-4 hidden">
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-1">Trust Name</label>
                    <input type="text" id="trustName" value="SAHAYA HASTHA" class="w-full px-3 py-2 border border-blue-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-xs font-medium text-gray-700 mb-1">Registered Address</label>
                    <input type="text" id="trustAddress" value="Madanthyar" class="w-full px-3 py-2 border border-blue-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-1">Phone Number</label>
                    <input type="text" id="trustPhone" value="+91 9518443651" class="w-full px-3 py-2 border border-blue-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-xs font-medium text-gray-700 mb-1">Email Address</label>
                    <input type="text" id="trustEmail" value="sahayahastha2811@gmail.com" class="w-full px-3 py-2 border border-blue-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
        </div>

        <!-- Header with Trust Branding -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-1 trust-logo">SAHAYA HASTHA</h1>
            <p class="text-sm text-gray-600 mb-1">Charitable Trust</p>
            <p class="text-xs text-gray-500">Receipt Printing System</p>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Input Form -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Receipt Details</h2>
                
                <!-- Donor Info -->
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Donor Name *</label>
                        <input type="text" id="donorName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter donor name">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Donor Phone</label>
                        <input type="tel" id="donorPhone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter phone number">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Donor Address</label>
                        <textarea id="donorAddress" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter address"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Receipt Date *</label>
                            <input type="date" id="receiptDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Receipt Number *</label>
                            <input type="text" id="receiptNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Auto-generated">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">PAN Number (if applicable)</label>
                        <input type="text" id="panNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Optional">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Received By</label>
                        <select id="receivedBy" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="SUNIL MORAS">SUNIL MORAS</option>
                            <option value="Others">Others</option>
                            <option value="Staff Member">Staff Member</option>
                            <option value="Volunteer">Volunteer</option>
                        </select>
                    </div>
                </div>

                <!-- Donation Items Section -->
                <div class="border-t pt-4 mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-medium text-gray-700">Donation Details</h3>
                        <button onclick="addItem()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-md text-sm">+ Add Item</button>
                    </div>
                    <div id="itemsList" class="space-y-2">
                        <!-- Items will be added here -->
                    </div>
                </div>

                <!-- Payment Details -->
                <div class="border-t pt-4 mb-6">
                    <h3 class="font-medium text-gray-700 mb-3">Payment Information</h3>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Payment Mode *</label>
                            <select id="paymentMode" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="Cash">Cash</option>
                                <option value="Cheque">Cheque</option>
                                <option value="Online Transfer">Online Transfer</option>
                                <option value="UPI">UPI</option>
                                <option value="DD">Demand Draft</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Reference No.</label>
                            <input type="text" id="referenceNumber" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Optional">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Bank Name</label>
                            <input type="text" id="bankName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="If applicable">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Branch</label>
                            <input type="text" id="branchName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="If applicable">
                        </div>
                    </div>
                </div>

                <!-- Purpose & Notes -->
                <div class="border-t pt-4 mb-6">
                    <h3 class="font-medium text-gray-700 mb-3">Purpose & Notes</h3>
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Donation Purpose</label>
                        <input type="text" id="purpose" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Education, Medical, General Fund">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                        <textarea id="notes" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Thank you for your generous donation!"></textarea>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 border-t pt-4">
                    <button onclick="generateReceipt()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md font-medium transition">Generate Receipt</button>
                    <button onclick="resetForm()" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-md font-medium transition">Reset</button>
                </div>
            </div>

            <!-- Receipt Preview -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Receipt Preview</h2>
                <div id="previewArea" class="text-center text-gray-500 py-12">
                    <svg class="w-16 h-16 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <p>Fill in the details and click "Generate Receipt" to see the preview</p>
                </div>
                
                <!-- Print Area (Hidden until generated) -->
                <div id="printArea" class="hidden">
                    <div class="receipt-preview p-6 max-w-md mx-auto">
                        <!-- Receipt Header -->
                        <div class="text-center border-b-2 border-gray-800 pb-3 mb-4">
                            <h2 class="text-2xl font-bold text-gray-800 trust-logo" id="displayTrustName">SAHAYA HASTHA</h2>
                            <p class="text-xs text-gray-600">Charitable Trust</p>
                            <p class="text-sm font-semibold mt-1">DONATION RECEIPT</p>
                            <p class="text-xs text-gray-500" id="displayReceiptNumber"></p>
                        </div>

                        <!-- Donor Info -->
                        <div class="mb-4 text-sm">
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <span class="font-semibold">Donor:</span>
                                    <span id="displayDonorName"></span>
                                </div>
                                <div>
                                    <span class="font-semibold">Phone:</span>
                                    <span id="displayDonorPhone"></span>
                                </div>
                                <div class="col-span-2">
                                    <span class="font-semibold">Address:</span>
                                    <span id="displayDonorAddress"></span>
                                </div>
                                <div>
                                    <span class="font-semibold">Date:</span>
                                    <span id="displayReceiptDate"></span>
                                </div>
                                <div>
                                    <span class="font-semibold">PAN:</span>
                                    <span id="displayPanNumber"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Donation Items Table -->
                        <div class="border-t border-b border-gray-300 my-3">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left py-1">Description</th>
                                        <th class="text-right py-1">Amount</th>
                                    </tr>
                                </thead>
                                <tbody id="displayItems">
                                    <!-- Items will be displayed here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Total Amount -->
                        <div class="flex justify-between font-bold text-lg my-2">
                            <span>Total Amount:</span>
                            <span id="displayTotalAmount"></span>
                        </div>

                        <!-- Amount in Words -->
                        <div class="text-sm border-t border-gray-300 pt-2 mb-3">
                            <span class="font-semibold">Amount in Words:</span>
                            <p id="displayAmountInWords" class="mt-1"></p>
                        </div>

                        <!-- Payment Details -->
                        <div class="text-sm border-t border-gray-300 pt-2 mb-3">
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <span class="font-semibold">Mode:</span>
                                    <span id="displayPaymentMode"></span>
                                </div>
                                <div>
                                    <span class="font-semibold">Ref No:</span>
                                    <span id="displayReferenceNumber"></span>
                                </div>
                                <div class="col-span-2" id="bankDetailsRow">
                                    <span class="font-semibold">Bank:</span>
                                    <span id="displayBankDetails"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Purpose -->
                        <div class="text-sm border-t border-gray-300 pt-2 mb-3">
                            <span class="font-semibold">Purpose:</span>
                            <p id="displayPurpose"></p>
                        </div>

                        <!-- Notes -->
                        <div class="text-sm pt-2 mb-3">
                            <p id="displayNotes"></p>
                        </div>

                        <!-- Trust Contact Info -->
                        <div class="text-sm border-t border-gray-300 pt-2 mb-3">
                            <p id="displayTrustPhone"></p>
                            <p id="displayTrustEmail"></p>
                        </div>

                        <!-- Received By -->
                        <div class="text-sm border-t border-gray-300 pt-2 mb-3">
                            <span class="font-semibold">Received By:</span>
                            <p id="displayReceivedBy"></p>
                        </div>

                        <!-- Footer -->
                        <div class="mt-6 text-center text-xs text-gray-500 border-t pt-3">
                            <p class="font-semibold" id="displayTrustNameFooter">SAHAYA HASTHA</p>
                            <p id="displayTrustAddress">Registered Address: Madanthyar</p>
                            <p class="mt-2">This is a computer-generated receipt. No signature required.</p>
                            <p class="mt-1">Thank you for your generous donation!</p>
                        </div>
                    </div>

                    <!-- Print Button -->
                    <div class="mt-4 flex justify-center no-print">
                        <button onclick="window.print()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-md font-medium transition">
                            üñ®Ô∏è Print Receipt
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize date to today
        document.getElementById('receiptDate').valueAsDate = new Date();
        
        // Load saved trust settings from localStorage
        function loadTrustSettings() {
            const savedName = localStorage.getItem('trustName');
            const savedAddress = localStorage.getItem('trustAddress');
            const savedPhone = localStorage.getItem('trustPhone');
            const savedEmail = localStorage.getItem('trustEmail');
            if (savedName) document.getElementById('trustName').value = savedName;
            if (savedAddress) document.getElementById('trustAddress').value = savedAddress;
            if (savedPhone) document.getElementById('trustPhone').value = savedPhone;
            if (savedEmail) document.getElementById('trustEmail').value = savedEmail;
        }

        // Save trust settings to localStorage
        function saveTrustSettings() {
            const trustName = document.getElementById('trustName').value;
            const trustAddress = document.getElementById('trustAddress').value;
            const trustPhone = document.getElementById('trustPhone').value;
            const trustEmail = document.getElementById('trustEmail').value;
            localStorage.setItem('trustName', trustName);
            localStorage.setItem('trustAddress', trustAddress);
            localStorage.setItem('trustPhone', trustPhone);
            localStorage.setItem('trustEmail', trustEmail);
        }

        // Toggle settings panel
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            const chevron = document.getElementById('settingsChevron');
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                chevron.style.transform = 'rotate(180deg)';
            } else {
                panel.classList.add('hidden');
                chevron.style.transform = 'rotate(0deg)';
            }
        }

        // Save settings when input changes
        document.getElementById('trustName').addEventListener('change', saveTrustSettings);
        document.getElementById('trustAddress').addEventListener('change', saveTrustSettings);
        document.getElementById('trustPhone').addEventListener('change', saveTrustSettings);
        document.getElementById('trustEmail').addEventListener('change', saveTrustSettings);

        // Generate receipt number
        function generateReceiptNumber() {
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const random = Math.floor(Math.random() * 1000);
            document.getElementById('receiptNumber').value = `SH-${year}${month}${day}-${random}`;
        }
        
        // Auto-generate receipt number on load
        generateReceiptNumber();

        // Item counter
        let itemCount = 0;

        // Add new item row
        function addItem() {
            itemCount++;
            const itemsList = document.getElementById('itemsList');
            const itemRow = document.createElement('div');
            itemRow.className = 'item-row grid grid-cols-12 gap-2 items-center bg-gray-50 p-2 rounded';
            itemRow.id = `item-${itemCount}`;
            
            itemRow.innerHTML = `
                <input type="text" placeholder="Description" class="col-span-8 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500" id="itemName-${itemCount}">
                <input type="number" placeholder="Amount" value="0" min="0" step="0.01" class="col-span-3 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500" id="itemAmount-${itemCount}" onchange="calculateItemTotal(${itemCount})">
                <button onclick="removeItem(${itemCount})" class="col-span-1 text-red-500 hover:text-red-700 text-sm font-bold">√ó</button>
            `;
            
            itemsList.appendChild(itemRow);
        }

        // Calculate item total
        function calculateItemTotal(id) {
            // This function is kept for consistency but not strictly needed for single amount field
            const amount = parseFloat(document.getElementById(`itemAmount-${id}`).value) || 0;
            // Visual feedback only
        }

        // Remove item
        function removeItem(id) {
            const itemRow = document.getElementById(`item-${id}`);
            if (itemRow) {
                itemRow.remove();
            }
        }

        // Number to words converter (Indian Rupees format)
        function numberToWords(num) {
            if (isNaN(num) || num < 0) return "Zero";
            if (num === 0) return "Zero";
            
            const ones = ["Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
            const tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
            
            function convertTwoDigit(n) {
                if (n < 20) {
                    return ones[Math.floor(n)];
                }
                const ten = Math.floor(n / 10);
                const one = n % 10;
                return tens[ten] + (one > 0 ? " " + ones[one] : "");
            }
            
            function convertThreeDigit(n) {
                let result = "";
                if (n >= 100) {
                    result = ones[Math.floor(n / 100)] + " Hundred";
                    n = n % 100;
                    if (n > 0) result += " ";
                }
                if (n > 0) {
                    result += convertTwoDigit(n);
                }
                return result;
            }
            
            let result = "";
            let crore = Math.floor(num / 10000000);
            let remainder = num % 10000000;
            
            if (crore > 0) {
                result += convertThreeDigit(crore) + " Crore ";
            }
            
            let lakh = Math.floor(remainder / 100000);
            remainder = remainder % 100000;
            
            if (lakh > 0) {
                result += convertThreeDigit(lakh) + " Lakh ";
            }
            
            let thousand = Math.floor(remainder / 1000);
            remainder = remainder % 1000;
            
            if (thousand > 0) {
                result += convertThreeDigit(thousand) + " Thousand ";
            }
            
            let hundred = Math.floor(remainder / 100);
            remainder = remainder % 100;
            
            if (hundred > 0) {
                result += convertThreeDigit(hundred) + " Hundred ";
            }
            
            if (remainder > 0) {
                result += convertTwoDigit(remainder);
            }
            
            return result.trim();
        }

        // Generate receipt
        function generateReceipt() {
            // Get trust settings
            const trustName = document.getElementById('trustName').value.trim() || 'SAHAYA HASTHA';
            const trustAddress = document.getElementById('trustAddress').value.trim() || 'Madanthyar';
            const trustPhone = document.getElementById('trustPhone').value.trim() || '+91 9518443651';
            const trustEmail = document.getElementById('trustEmail').value.trim() || 'sahayahastha2811@gmail.com';

            // Get donor info
            const donorName = document.getElementById('donorName').value.trim();
            const donorPhone = document.getElementById('donorPhone').value.trim();
            const donorAddress = document.getElementById('donorAddress').value.trim();
            const receiptDate = document.getElementById('receiptDate').value;
            const receiptNumber = document.getElementById('receiptNumber').value;
            const panNumber = document.getElementById('panNumber').value.trim();
            const notes = document.getElementById('notes').value.trim() || 'Thank you for your generous donation!';

            // Validate donor info
            if (!donorName) {
                alert('Please enter donor name');
                return;
            }
            if (!receiptDate) {
                alert('Please enter receipt date');
                return;
            }
            if (!receiptNumber) {
                alert('Please enter receipt number');
                return;
            }

            // Get items
            const items = [];
            const itemRows = document.querySelectorAll('[id^="item-"]');
            
            if (itemRows.length === 0) {
                alert('Please add at least one donation item');
                return;
            }

            itemRows.forEach(row => {
                const id = row.id.split('-')[1];
                const name = document.getElementById(`itemName-${id}`).value.trim();
                const amount = parseFloat(document.getElementById(`itemAmount-${id}`).value) || 0;
                
                if (name && amount > 0) {
                    items.push({ name, amount });
                }
            });

            if (items.length === 0) {
                alert('Please add valid donation items with description and amount');
                return;
            }

            // Get payment info
            const paymentMode = document.getElementById('paymentMode').value;
            const referenceNumber = document.getElementById('referenceNumber').value.trim();
            const bankName = document.getElementById('bankName').value.trim();
            const branchName = document.getElementById('branchName').value.trim();
            const purpose = document.getElementById('purpose').value.trim();
            const receivedBy = document.getElementById('receivedBy').value.trim();

            // Calculate total
            const totalAmount = items.reduce((sum, item) => sum + item.amount, 0);

            // Update display
            document.getElementById('displayTrustName').textContent = trustName;
            document.getElementById('displayTrustNameFooter').textContent = trustName;
            document.getElementById('displayTrustAddress').textContent = `Registered Address: ${trustAddress}`;
            document.getElementById('displayTrustPhone').textContent = `Phone: ${trustPhone}`;
            document.getElementById('displayTrustEmail').textContent = `Email: ${trustEmail}`;
            document.getElementById('displayReceivedBy').textContent = receivedBy;
            document.getElementById('displayDonorName').textContent = donorName;
            document.getElementById('displayDonorPhone').textContent = donorPhone || '-';
            document.getElementById('displayDonorAddress').textContent = donorAddress || '-';
            document.getElementById('displayReceiptDate').textContent = receiptDate;
            document.getElementById('displayReceiptNumber').textContent = receiptNumber;
            document.getElementById('displayPanNumber').textContent = panNumber || '-';

            // Display items
            const displayItems = document.getElementById('displayItems');
            displayItems.innerHTML = '';
            items.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'border-b last:border-b-0';
                row.innerHTML = `
                    <td class="py-1">${item.name}</td>
                    <td class="text-right py-1">‚Çπ${item.amount.toFixed(2)}</td>
                `;
                displayItems.appendChild(row);
            });

            // Display total
            document.getElementById('displayTotalAmount').textContent = `‚Çπ${totalAmount.toFixed(2)}`;

            // Display amount in words
            const rupees = Math.floor(totalAmount);
            const paise = Math.round((totalAmount - rupees) * 100);
            let amountInWords = numberToWords(rupees) + " Rupees";
            if (paise > 0) {
                amountInWords += " and " + numberToWords(paise) + " Paise";
            }
            document.getElementById('displayAmountInWords').textContent = amountInWords + " Only";

            // Display payment details
            document.getElementById('displayPaymentMode').textContent = paymentMode;
            document.getElementById('displayReferenceNumber').textContent = referenceNumber || '-';

            // Bank details
            const bankDetailsRow = document.getElementById('bankDetailsRow');
            if (bankName || branchName) {
                bankDetailsRow.classList.remove('hidden');
                const bankDetails = [bankName, branchName].filter(Boolean).join(', ');
                document.getElementById('displayBankDetails').textContent = bankDetails;
            } else {
                bankDetailsRow.classList.add('hidden');
            }

            // Purpose
            document.getElementById('displayPurpose').textContent = purpose || '-';

            // Notes
            document.getElementById('displayNotes').textContent = notes;

            // Show print area, hide preview
            document.getElementById('previewArea').classList.add('hidden');
            document.getElementById('printArea').classList.remove('hidden');
        }

        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset all fields?')) {
                document.getElementById('donorName').value = '';
                document.getElementById('donorPhone').value = '';
                document.getElementById('donorAddress').value = '';
                document.getElementById('receiptDate').valueAsDate = new Date();
                generateReceiptNumber();
                document.getElementById('panNumber').value = '';
                document.getElementById('itemsList').innerHTML = '';
                document.getElementById('paymentMode').value = 'Cash';
                document.getElementById('referenceNumber').value = '';
                document.getElementById('bankName').value = '';
                document.getElementById('branchName').value = '';
                document.getElementById('purpose').value = '';
                document.getElementById('notes').value = '';
                document.getElementById('previewArea').classList.remove('hidden');
                document.getElementById('printArea').classList.add('hidden');
                itemCount = 0;
            }
        }

        // Add one empty item row by default
        addItem();
        
        // Load saved trust settings
        loadTrustSettings();
    </script>
</body>
</html>